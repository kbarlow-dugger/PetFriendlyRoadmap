<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8">
<title>Pet Friendly Roadmap</title>
<meta name="viewport" content="initial-scale=1,maximum-scale=1">
<link href="https://api.mapbox.com/mapbox-gl-js/v2.8.2/mapbox-gl.css" rel="stylesheet">
<script src="https://api.mapbox.com/mapbox-gl-js/v2.8.2/mapbox-gl.js"></script>
<style>
body { margin: 0; padding: 0; background-color: #303030; color:#F0F0F0; font-family: sans-serif; }

.header {
  overflow: hidden;
  background-color: #f1f1f1;
  padding: 20px 10px;
}

.header a {
  float: left;
  color: black;
  text-align: center;
  padding: 12px;
  text-decoration: none;
  font-size: 18px;
  line-height: 25px;
  border-radius: 4px;
}

.header a.logo {
  font-size: 30px;
  font-weight: bold;
  font-family: Montserrat, Verdana, sans-serif; 
  font-type: montserrat;
}

.header a:hover {
  background-color: #ddd;
  color: black;
}

.header a.active {
  background-color: #006699;
  color: white;
}

.header-right {
  float: right;
}

@media screen and (max-width: 500px) {
  .header a {
    float: none;
    display: block;
    text-align: left;
	margin-top: 5px;
	font-size: 15px;	
  }
  .header-right {
    float: none;
  }
}

.listings {
height: 100%;
overflow: auto;
padding-bottom: 60px;
}
 
.listings .item {
display: block;
border-bottom: 1px solid #eee;
padding: 10px;
color: white;
text-decoration: none;
}
 
.listings .item:last-child {
border-bottom: none;
}
.listings .item .title {
display: block;
color: #00853e;
font-weight: 700;
}
 
.listings .item .title small {
font-weight: 300;
}
.listings .item.active .title,
.listings .item .title:hover {
color: #8cc63f;
}
.listings .item.active {
background-color: #f8f8f8;
}

#map-container {
    position: relative;
    height: 600px; 
    width: 98%;
	text-align: center;
}

#map {
    position: relative;
    height: inherit;
    width: inherit;
}

#menu {
background: #fff;
position: relative;
z-index: 1;
top: 15px;
left: 10px;
border-radius: 3px;
width: 185px;
border: 1px solid rgba(0, 0, 0, 0.4);
font-family: 'Open Sans', sans-serif;
margin-bottom: 25px; 
}
 
#menu a {
font-size: 20px;
color: #404040;
display: block;
margin: 0;
padding: 0;
padding: 10px;
text-decoration: none;
border-bottom: 1px solid rgba(0, 0, 0, 0.25);
text-align: left;
}
 
#menu a:last-child {
border: none;d
}
 
#menu a:hover {
background-color: #f8f8f8;
color: #404040;
}
 
#menu a.active {
background-color: #3887be;
color: #ffffff;
}
 
#menu a.active:hover {
background: #006699;
}
</style>
</head>

<body>

<div class="header">
  <img src="images/hotel-indigo.jpg" align="left" height="70px" border="0" style="padding:0 10px; 10px 10px;">
  <a class="logo" href="http://www.druryinns.com" target="_top">Hotel Indigo - Columbus, IN</a>
  <div class="header-right">
  <!--  <a class="active" href="#home">Home</a>  -->
    <a class="active" href="mailto:dugger@duggerdinners.com?subject=Pet Friendly Roadmap">Feedback</a>
	<a href="https://www.duggerdinners.com" style="color:#006699;">Powered by Dugger Dinners</a>
  </div>
</div>

<div class="main">
    <div style="float:left; width: 24%; margin-right: 3% margin-bottom: 30px; ">
		<div id="menu" style="width:100%;"></div>
	</div>
	<div style="float:right; width: 67%; color: #E0E0E0; padding-right: 5%; padding-left: 1%; margin-top: 0px; ">
	<h2 style="color: #F0F0F0; font-size:150%; ">PET FRIENDLY ROADMAP</h2>
	<p>Welcome to <b>Dugger Dinners' Pet Friendly Roadmap</b> - which is a cool directory for you and your dog. It's a resource of all of the great pet-friendly places and services that are within a short distance of where you are staying. Use the buttons to the left to toggle on and off by location type. Use the Feedback button at the top to provide Dugger and his team feedback or more ideas.</p></div>
</div>

<br clear="all">
<div id="map-container" style="padding: 10px 10px 10px 10px; border:1px solid #C0C0C0; ">
  <div id="map">
  </div>
</div>

<hr>
<h2 style="padding-left: 10px;">Pet Friendly Restaurants</h2>
<div id="listings" class="listings"></div>
<h2 style="padding-left: 10px;">Dog Friendly Parks</h2>
<div id="listings_2" class="listings"></div>
<h2 style="padding-left: 10px;">Various Pet Services</h2>
<div id="listings_3" class="listings"></div>

<script>

mapboxgl.accessToken = 'pk.eyJ1Ijoia2Jhcmxvdy1kdWdnZXIiLCJhIjoiY2w0d3BxM29hMWkxMzNpcW51Z3ZsNmh2OCJ9.UoHLNslkQOXjDkOCH9bfHg';

const map = new mapboxgl.Map({
container: 'map',
style: 'mapbox://styles/mapbox/light-v10',
zoom: 14,
center: [-77.034084142948,38.900671288923]
});

map.addControl(new mapboxgl.NavigationControl());

const food_ct = 3;
const food = 

{'type': 'FeatureCollection','features': [

{'type': 'Feature','geometry': {'type': 'Point','coordinates': [-77.034084142948, 38.909671288923]},'properties': {'name': 'Ronald Reagan Dog-Friendly Pizza','phone': '2022347336','address': '1471 P St NW','city': 'Washington','country': 'United States','category': 'Pizza','postalCode': '20005','state': 'D.C.'}},

{'type': 'Feature','geometry': {'type': 'Point','coordinates': [-77.049766, 38.900772]},'properties': {'name': 'Abe Lincoln Burgers & Bones','phone': '2025078357','address': '2221 I St NW','city': 'Washington','country': 'United States','category': 'Restaurant','postalCode': '20037','state': 'D.C.'}},

{'type': 'Feature','geometry': {'type': 'Point','coordinates': [-77.043929, 38.910525]},'properties': {'name': 'Jefferson and Sons Deli','phone': '2023879338','address': '1512 Connecticut Ave NW','city': 'Washington','country': 'United States','category': 'Restaurant','postalCode': '20036','state': 'D.C.' }}, 

]};

/**
* Assign a unique id to each store. You'll use this `id`
* later to associate each point on the map with a listing
* in the sidebar.
*/
food.features.forEach((foodplace, i) => {
foodplace.properties.id = i;
});

const petsvcs_ct = 2;
const petsvcs = 

{'type': 'FeatureCollection','features': [

{'type': 'Feature','geometry': {'type': 'Point','coordinates': [-77.0672, 38.90516896]},'properties': {'name': 'Franklin D for Dog Spa','phone': '2023379338','address': '3333 M St NW','city': 'Washington','country': 'United States','crossStreet': 'at 34th St NW','postalCode': '20007','state': 'D.C.'}},

{'type': 'Feature','geometry': {'type': 'Point','coordinates': [-77.002583742142, 38.900041080933]},'properties': {'name': 'DC City Emergency Vet','phone': '2025479338','address': '221 Pennsylvania Ave SE','city': 'Washington','country': 'United States','crossStreet': 'btwn 2nd & 3rd Sts. SE','postalCode': '20003','state': 'D.C.'}},

]};

/**
* Assign a unique id to each store. You'll use this `id`
* later to associate each point on the map with a listing
* in the sidebar.
*/
petsvcs.features.forEach((petsvc, i) => {
petsvc.properties.id = i;
});

const dogparks_ct = 1;
const dogparks = 

{'type': 'FeatureCollection','features': [

 {'type': 'Feature','geometry': {'type': 'Point','coordinates': [-77.026559, 38.902781]},'properties': {'name': 'Bojangles and Dog Park','address': '1011 K St NW','city': 'Washington','country': 'United States','postalCode': '20001','state': 'DC'}}, 

]};

/**
* Assign a unique id to each store. You'll use this `id`
* later to associate each point on the map with a listing
* in the sidebar.
*/
dogparks.features.forEach((dogpark, i) => {
dogpark.properties.id = i;
});
 
// Wait until the map has finished loading.
map.on('load', () => {

	// Add Pet Friendly Restaurants data 
	map.addSource('pet friendly restaurants', {
		'type': 'geojson',
		'data': food
	});

	buildLocationList(food,"food");
		
	map.addLayer({
		'id': 'pet friendly restaurants',
		'type': 'circle',
		'source': 'pet friendly restaurants',
		'layout': {
		// Make the layer visible by default.
		'visibility': 'visible',
		},
		'paint': {
		'circle-radius': 11,
		'circle-color': 'rgba(0,133,62,1)'
		}
	});
 
	// Add the Pet Services items 
	map.addSource('pet services', {
		'type': 'geojson',
		'data': petsvcs
	});
		
	buildLocationList2(petsvcs,"services");
	
	map.addLayer({
		'id': 'pet services',
		'type': 'circle',
		'source': 'pet services',
		'layout': {
		// Make the layer visible by default.
		'visibility': 'visible',
		},
		'paint': {
		'circle-radius': 11,
		'circle-color': 'rgba(127,0,0,1)'
		}
	});

	// Add the Dog Friendly Parks 
	map.addSource('dog friendly parks', {
		'type': 'geojson',
		'data': dogparks
	});

	buildLocationList3(dogparks,"parks");
	
	map.addLayer({
		'id': 'dog friendly parks',
		'type': 'circle',
		'source': 'dog friendly parks',
		'layout': {
		// Make the layer visible by default.
		'visibility': 'visible',
		},
		'paint': {
		'circle-radius': 11,
		'circle-color': 'rgba(61,114,196,1)'
		}
	});
	
	map.loadImage(
		'https://kbarlow-dugger.github.io/PetFriendlyRoadmap/dugger-icon.png',
		(error, image) => {
		if (error) throw error;
 
			// Add the image to the map style.
			map.addImage('cat', image);
 
			// Add a data source containing one point feature.
			map.addSource('point', {
				'type': 'geojson',
				'data': {
				'type': 'FeatureCollection',
				'features': [
				{
				'type': 'Feature',
				'geometry': {
				'type': 'Point',
			'coordinates': [-77.036674, 38.897606]
			}
			}
			]
			}
		});
 
		// Add a layer to use the image to represent the data.
		map.addLayer({
			'id': 'points',
			'type': 'symbol',
			'source': 'point', // reference the data source
			'layout': {
			'icon-image': 'cat', // reference the image
			'icon-size': 0.6
			}
		});
	});
	
	function buildLocationList(stores, parm) {
	for (const store of stores.features) {

	const listings = document.getElementById('listings');
	const listing = listings.appendChild(document.createElement('div'));

	/* if (parm.value === 'services') {
		const listings_2 = document.getElementById('listings_2');
		const listing = listings_2.appendChild(document.createElement('div'));
	}	
	if (parm.value === 'parks') {
		const listings_3 = document.getElementById('listings_3');
		const listing = listings_3.appendChild(document.createElement('div'));
	}	 */
	
	/* Assign a unique `id` and class to each item in the listing. */
	listing.id = `listing-${store.properties.id}`;
	listing.className = 'item';
	
	/* Add details to the individual listing. */
	const details = listing.appendChild(document.createElement('div'));
	details.innerHTML = `${store.properties.name}`;
	details.style.fontWeight = '800';
	details.style.paddingBottom = '3px';
	if (store.properties.category) { details.innerHTML += ` (${store.properties.category})`; }		

	/* Add the link to the individual listing created above. */
	const link = listing.appendChild(document.createElement('a'));
	link.className = 'title';
	link.id = `link-${store.properties.id}`;
	link.href = `https://www.google.com/maps/place/`; 
	link.href += `${store.properties.address}+${store.properties.city}`;
	link.href += `+${store.properties.state}+${store.properties.postalCode}`;
	link.target = '_new';	
	link.innerHTML = `${store.properties.address} &middot; ${store.properties.city} ${store.properties.state}`;

	}}; /* end of buildLocation List function */
	
	function buildLocationList2(stores, num) {
	for (const store of stores.features) {
	/* Add a new listing section to bottom of the page. */
	const listings_2 = document.getElementById('listings_2');
	const listing = listings_2.appendChild(document.createElement('div'));
	/* Assign a unique `id` and class to each item in the listing. */
	listing.id = `listing-${store.properties.id}`;
	listing.className = 'item';

	/* Add details to the individual listing. */
	const details = listing.appendChild(document.createElement('div'));
	details.innerHTML = `${store.properties.name}`;
	details.style.fontWeight = '800';
	details.style.paddingBottom = '3px';	
	if (store.properties.category) { details.innerHTML += ` (${store.properties.category})`; }		

	/* Add the link to the individual listing created above. */
	const link = listing.appendChild(document.createElement('a'));
	link.className = 'title';
	link.id = `link-${store.properties.id}`;
	link.href = `https://www.google.com/maps/place/`; 
	link.href += `${store.properties.address}+${store.properties.city}`;
	link.href += `+${store.properties.state}+${store.properties.postalCode}`;
	link.target = '_new';	
	link.innerHTML = `${store.properties.address} &middot; ${store.properties.city} ${store.properties.state}`;

	}}; /* end of buildLocation List function */
	
	function buildLocationList3(stores, num) {
	for (const store of stores.features) {
	/* Add a new listing section to bottom of the page. */
	const listings_3 = document.getElementById('listings_3');
	const listing = listings_3.appendChild(document.createElement('div'));
	/* Assign a unique `id` and class to each item in the listing. */
	listing.id = `listing-${store.properties.id}`;
	listing.className = 'item';

	/* Add details to the individual listing. */
	const details = listing.appendChild(document.createElement('div'));
	details.innerHTML = `${store.properties.name}`;
	details.style.fontWeight = '800';
	details.style.paddingBottom = '3px';	
	if (store.properties.category) { details.innerHTML += ` (${store.properties.category}) target=_new`; }		

	/* Add the link to the individual listing created above. */
	const link = listing.appendChild(document.createElement('a'));
	link.className = 'title';
	link.id = `link-${store.properties.id}`;
	link.href = `https://www.google.com/maps/place/`; 
	link.href += `${store.properties.address}+${store.properties.city}`;
	link.href += `+${store.properties.state}+${store.properties.postalCode}`;
	link.target = '_new';	
	link.innerHTML = `${store.properties.address} &middot; ${store.properties.city} ${store.properties.state} target=_new`;

	}}; /* end of buildLocation List function */

});  // end of map.on LOAD 
 
// After the last frame rendered before the map enters an "idle" state.
map.on('idle', () => {
// If these two layers were not added to the map, abort
if (!map.getLayer('pet friendly restaurants') || !map.getLayer('pet services')) {
return;
}
 
// Enumerate ids of the layers.
const toggleableLayerIds = ['pet friendly restaurants','dog friendly parks','pet services'];
 
// Set up the corresponding toggle button for each layer.
for (const id of toggleableLayerIds) {
// Skip layers that already have a button set up.
if (document.getElementById(id)) {
continue;
}
 
// Create a link.
const link = document.createElement('a');
link.id = id;
link.href = '#';

/*  if (id == 'pet friendly restaurants') { num = food_ct; }
	if (id == 'dog friendly parks') { num = dogparks_ct; }
	if (id == 'pet services') { num = petsvcs_ct; } 
	link.textContent = id + ' (' + num + ')';  */
 
link.textContent = id;

link.style.backgroundImage = 'url(images/map-icons/map-' + id.substr(0,3) + id.substr(4,2) + '.png)'; 
link.style.backgroundRepeat = 'no-repeat'; 
link.style.backgroundPosition = 'right 5% top 50%';

link.className = 'active';
 
// Show or hide layer when the toggle is clicked.
link.onclick = function (e) {
const clickedLayer = this.textContent;
e.preventDefault();
e.stopPropagation();
 
const visibility = map.getLayoutProperty(clickedLayer,'visibility');
 
// Toggle layer visibility by changing the layout object's visibility property.
if (visibility === 'visible') {
map.setLayoutProperty(clickedLayer, 'visibility', 'none');
this.className = '';
} else {
this.className = 'active';
map.setLayoutProperty(clickedLayer,'visibility','visible');
}
};
 
const layers = document.getElementById('menu');
layers.appendChild(link);
}
});


  /* ******* FUNCTIONALITY FOR POP-UPS OVER MAP ITEMS ***********************/
  /* Add an event listener that runs when a user clicks on the map element. */
  map.on('click', (event) => {
  // If the user clicked on one of your markers, get its information.
  const features = map.queryRenderedFeatures(event.point, {
    layers: ['pet friendly restaurants','pet services', 'dog friendly parks'] // replace with your layer name
  });
  if (!features.length) {
    return;
  }
  const feature = features[0];

  /* Create a popup, specify its options and properties, and add it to the map.  */
  const popup = new mapboxgl.Popup({ offset: [0, -15] })
  .setLngLat(feature.geometry.coordinates)
  
  /* removed use by lat long of properties.geometry.coordinates[1] and [0] */  
  .setHTML(
	'<div style="padding-bottom: 8px;"></div><div style="padding: 10px 10px 10px 10px; background-color:#efefee; font-size: 140%;"><strong>' + feature.properties.name + '</strong></div><div style="font-size:140%; padding-top:10px;">' + feature.properties.address + '</div><div><a target="_new" href="https://www.google.com/maps/place/' + feature.properties.address + '+' + feature.properties.city + '+' + feature.properties.state + '+' + feature.properties.postalCode + '">view in google maps</div>'
  )
  
  .addTo(map);
  
});

</script>
 
</body>
</html>
